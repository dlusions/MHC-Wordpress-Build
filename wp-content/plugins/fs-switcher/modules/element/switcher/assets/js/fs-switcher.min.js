/*!
 * @package     [FS] Switcher Pro for YOOtheme Pro
 * @subpackage  fs-switcher
 *
 * @author      Flart Studio https://flart.studio
 * @copyright   Copyright (C) 2026 Flart Studio. All rights reserved.
 * @license     Flart Studio Proprietary License â€” see https://flart.studio/license
 * @link        https://flart.studio/yootheme-pro/switcher
 * @build       (FLART_BUILD_NUMBER)
 *
 * Use of this file is subject to license terms. Redistribution is strictly prohibited.
 */
(()=>{"use strict";const e="[data-fs-switcher]:not([data-initialized]):not([data-init-failed])",t="[data-fs-switcher-nav]",s="[data-fs-switcher-nav-link]",i="[data-fs-switcher-hover-area]",r="[data-fs-switcher-progress-bar]",o="[data-fs-switcher-items]",n="[data-fs-switcher-item-link]",l="[data-edit-mode]",a=".fs-switcher-toggle",c="data-initialized",h="data-initializing",u="data-init-failed",d="data-scroll-offset",g="uk-active",p="uk-open",m="uk-active",v={selector:e,container:null,debug:!1,builderIntegration:!0,observeDOM:!0,excludeIds:["page#","header#","footer#","menu-item-","module-","widget-","builderwidget-"],autoplayInterval:7e3,scrollOffset:50,scrollDelay:300,scrollDuration:800,dragThreshold:5};class f{static#e=null;static#t=null;static#s=0;static getInstance(e={}){return f.#e||(f.#e=new f(e)),f.#e}static reset(){f.#e&&(f.#e.destroy(),f.#e=null)}constructor(e={}){if(f.#e)return f.#e;const t=document.body||document.documentElement;this.options={...v,container:t,...e},this.options.container||(this.options.container=document.body||document.documentElement),this.switchers=new Map,this.toggles=new Map,this.domObserver=null,this.builderObserver=null,this.isBuilderContext=!1,this.hashHandler=null,this.isScrolled=!1,this.scrollTimer=null,this.capabilities={hover:window.matchMedia("(hover: hover)").matches,touch:window.matchMedia("(pointer: coarse)").matches},this.isTabVisible=!0,this.visibilityHandler=null,this.scrollAnimationId=null,this.#i()}#i(){this.#r()&&(this.#o(),this.#n(),this.#l(),this.#a(),this.#c(),this.options.builderIntegration&&this.isBuilderContext&&this.#h(),this.options.observeDOM&&this.#u(),this.#d(),this.#g("info","Switcher manager initialized"))}#r(){return"undefined"!=typeof UIkit||(this.#g("error","UIkit is required but not found"),!1)}#o(){try{this.isBuilderContext=!(!window.parent||window.parent===window||!window.parent.Vue?.events)}catch{this.isBuilderContext=!1}}#l(){if(!this.options.container&&(this.options.container=document.body||document.documentElement,!this.options.container))return void this.#g("warn","Container not available yet, delaying initialization");const e=`${this.options.selector}:not([${h}])`,t=this.options.container.querySelectorAll(e);let s=0;t.forEach((e=>{this.#p(e)&&s++})),s>0&&this.#g("info",`Processed ${s} switcher(s)`)}#p(e){if(e.querySelector(l))return this.#g("debug","Skipping switcher in edit mode"),!1;if(this.switchers.has(e)||e.hasAttribute(c))return!1;e.setAttribute(h,"true");try{const s=e.querySelector(t);if(!s)return this.#g("warn",`Missing navigation for switcher: ${this.#m(e)}`),e.removeAttribute(h),e.setAttribute(u,"true"),!1;const i=this.#v(e),r={wrapper:e,nav:s,style:e.dataset.style||"tab",mode:e.dataset.mode||"click",initialized:!0,options:i,handlers:{click:null,mouseover:null,mouseleave:null,scrollClick:null,scrollHover:null},autoplay:null,toggles:new Set};return this.switchers.set(e,r),this.#f(r),this.#w(r),this.#b(r),this.#y(r),this.#S(r),this.#T(r),this.#A(r),e.removeAttribute(h),e.setAttribute(c,"true"),this.#g("info",`Switcher initialized: ${this.#m(e)}`),!0}catch(t){return this.#g("error",`Failed to initialize switcher: ${this.#m(e)}`,t),e.removeAttribute(h),e.setAttribute(u,"true"),this.switchers.delete(e),!1}}#v(e){const t=e.dataset,s={};if(t.autoplay){const e={};t.autoplay.split(";").forEach((t=>{const[s,i]=t.split(":").map((e=>e.trim()));s&&i&&(e[s]=isNaN(Number(i))?i:parseFloat(i))})),s.autoplay=e}return s.scroll="true"===t.scroll,s.click="1"===t.click,s.scrollOffset=this.#E(e.getAttribute(d)),s}#E(e){if(null==e||""===e)return this.options.scrollOffset;const t=parseInt(e,10);return isNaN(t)?this.options.scrollOffset:t}#f(e){const{nav:t}=e;t.querySelectorAll(":scope > *").forEach(((e,t)=>{e.dataset.index=String(t)})),this.#g("debug",`Switcher setup complete: ${this.#m(e.wrapper)}`)}#a(){const e=(document.body||document.documentElement||document).querySelectorAll(a);e.forEach((e=>{this.#k(e)})),e.length>0&&this.#g("info",`Processed ${e.length} toggle(s)`)}#k(e){if(this.toggles.has(e))return;const t=e.getAttribute("id"),s=!e.classList.contains("fs-no-scroll");e.querySelectorAll("a[uk-scroll]").forEach((e=>{e.removeAttribute("uk-scroll")}));const i={element:e,id:t,useScroll:s,handlers:{mousedown:null,mousemove:null,click:null},dragState:{startX:0,startY:0,isDragging:!1}};this.toggles.set(e,i),this.#I(i)}#I(e){const{element:t,dragState:s}=e;e.handlers.mousedown=e=>{s.startX=e.clientX,s.startY=e.clientY,s.isDragging=!1},e.handlers.mousemove=e=>{const t=Math.abs(e.clientX-s.startX),i=Math.abs(e.clientY-s.startY);(t>this.options.dragThreshold||i>this.options.dragThreshold)&&(s.isDragging=!0)},e.handlers.click=t=>{this.#L(t,e)},t.addEventListener("mousedown",e.handlers.mousedown),t.addEventListener("mousemove",e.handlers.mousemove),t.addEventListener("click",e.handlers.click)}#L(e,t){if(t.dragState.isDragging)return;const s=e.target.closest("a");if(!s||"A"!==s.tagName||s.hasAttribute("aria-controls"))return;const i=s.getAttribute("href");i&&(e.preventDefault(),e.stopPropagation(),this.#H(t,s,i),history.pushState(null,"",i))}#H(e,t,s){const{element:i,id:r,useScroll:o}=e;if(this.#O(i,t),r&&!this.#x(r)){const e=document.querySelector(`#fs-${r}`);if(e){const t=this.switchers.get(e);t&&(this.isTargetedActivation=!0,this.#q(t,s,o,!0),this.#B(s,r))}}else this.switchers.forEach((e=>{e.nav.querySelector(`a[href="${s}" i]`)&&this.#q(e,s,o,!1)})),this.#B(s,null)}#w(e){if("hover"!==e.mode||!this.capabilities.hover)return;const{nav:t,style:i,options:r}=e;let l,a;e.handlers.mouseover=e=>{const r=e.target.closest(s);r&&(clearTimeout(l),l=setTimeout((()=>{t.querySelectorAll("a").forEach((e=>e.classList.remove(m))),r.classList.add(m),a=r.parentNode.dataset.index,this.#$(t,i,a)}),100))},e.handlers.mouseleave=()=>clearTimeout(l),t.addEventListener("mouseover",e.handlers.mouseover),t.addEventListener("mouseleave",e.handlers.mouseleave),r.click&&t.addEventListener("click",(t=>{if(t.preventDefault(),t.target.closest(s)){const t=e.wrapper.querySelector(`${o} div[data-index="${a}"] ${n}`);t&&t.click()}}))}#b(e){const{options:t,wrapper:s,nav:o,style:n}=e;if(!t.autoplay||!t.autoplay.autoplay)return;const l=t.autoplay,a=l.autoplayInterval||this.options.autoplayInterval,c=l.pauseOnHover,h=l.autoplayProgress,u=s.querySelector(i),d=s.querySelector(r),m="accordion"===n?p:g,v=o.querySelector(`:scope > .${m}`);let f=v?parseInt(v.dataset.index,10):0;e.autoplay={timer:null,startTime:null,remainingTime:a,activeIndex:f,pauseCount:0,interval:a,pauseOnHover:c,hasProgress:h,progressBar:d},this.#M(e),c&&u&&this.#C(e,u)}#M(e,t=!1){const{autoplay:s}=e;s&&(clearTimeout(s.timer),t&&(s.remainingTime=s.interval,s.hasProgress&&s.progressBar&&(s.progressBar.style.transition="none",s.progressBar.style.width="0")),this.#D(e),t||(s.startTime=Date.now()))}#D(e){const{autoplay:t,nav:s}=e;if(!t)return;const i=s.querySelectorAll(":scope > *");t.startTime=Date.now(),t.timer=setTimeout((()=>{t.activeIndex=(t.activeIndex+1)%i.length,this.#$(s,e.style,t.activeIndex),this.#F(e)}),t.remainingTime),t.hasProgress&&t.progressBar&&requestAnimationFrame((()=>{t.progressBar.style.transition=`width ${t.remainingTime}ms linear`,t.progressBar.style.width="100%"}))}#A(e){const t=e.wrapper;new IntersectionObserver((t=>{t.forEach((t=>{t.isIntersecting?this.#N(e):this.#z(e)}))}),{threshold:.1}).observe(t)}#z(e){const{autoplay:t}=e;if(t){if(0===t.pauseCount){clearTimeout(t.timer);const e=Date.now()-t.startTime;if(t.remainingTime-=e,t.hasProgress&&t.progressBar){const e=Math.max(0,1-t.remainingTime/t.interval);t.progress=e,t.progressBar.style.transition="none",t.progressBar.style.width=100*e+"%",t.progressBar.offsetHeight}}t.pauseCount++}}#N(e){const{autoplay:t}=e;t&&0!==t.pauseCount&&(t.pauseCount--,t.pauseCount>0||(t.startTime=Date.now(),t.hasProgress&&t.progressBar&&requestAnimationFrame((()=>{t.progressBar.style.transition=`width ${t.remainingTime}ms linear`,t.progressBar.style.width="100%"})),t.timer=setTimeout((()=>{t.activeIndex=(t.activeIndex+1)%e.nav.children.length,this.#$(e.nav,e.style,t.activeIndex),this.#F(e)}),t.remainingTime)))}#F(e){const{autoplay:t}=e;t&&(clearTimeout(t.timer),t.remainingTime=t.interval,t.hasProgress&&t.progressBar&&(t.progressBar.style.transition="none",t.progressBar.style.width="0%",t.progressBar.offsetHeight),0===t.pauseCount&&this.#M(e,!0))}#C(e,t){const s=()=>this.#z(e),i=()=>this.#N(e);(this.capabilities.touch||this.capabilities.hover)&&(["touchstart","mouseenter"].forEach((e=>t.addEventListener(e,s))),["touchend","mouseleave"].forEach((e=>t.addEventListener(e,i))))}#T(e){const{nav:t,style:s}=e,i=t.querySelectorAll(":scope > *"),r="accordion"===s?p:g,o=new MutationObserver((t=>{t.forEach((t=>{if("class"!==t.attributeName)return;const s=t.target,i=t.oldValue?t.oldValue.split(" "):[],o=s.className.split(" ");if(!i.includes(r)&&o.includes(r)&&(this.#U(e,s),e.autoplay)){parseInt(s.dataset.index,10)!==e.autoplay.activeIndex&&this.#V(e,s)}}))}));i.forEach((e=>o.observe(e,{attributes:!0,attributeFilter:["class"],attributeOldValue:!0})))}#V(e,t){e.autoplay&&t&&(e.autoplay.activeIndex=parseInt(t.dataset.index,10),this.#F(e))}#y(e){if(!e.options.scroll)return;const{nav:t,wrapper:i,style:r,options:o}=e;let n;e.handlers.scrollClick=e=>{const t=e.target.closest(s);if(t&&"multiple"!==i.dataset.accordion){const e="accordion"===r?t:i;this.#P(e,r,o.scrollOffset)}},t.addEventListener("click",e.handlers.scrollClick),"hover"===e.mode&&this.capabilities.hover&&(e.handlers.scrollHover=e=>{const t=e.target.closest(s);t&&"multiple"!==i.dataset.accordion&&(clearTimeout(n),n=setTimeout((()=>{if(t.matches(":hover")){const e="accordion"===r?t:i;this.#P(e,r,o.scrollOffset)}}),200))},t.addEventListener("mouseover",e.handlers.scrollHover))}#P(e,t,s){this.scrollTimer&&clearTimeout(this.scrollTimer),this.isScrolled=!0,this.scrollTimer=setTimeout((()=>{const i=s??this.options.scrollOffset,r=e.getBoundingClientRect(),o=window.scrollY||document.documentElement.scrollTop,n=r.top+o;if("accordion"!==t){const e=window.innerHeight||document.documentElement.clientHeight;if(r.top>=0&&r.top<e)return this.isScrolled=!1,this.scrollTimer=null,void this.#Y()}const l=Math.min(i,n),a=Math.max(0,n-l);this.#R(a,this.options.scrollDuration,(()=>{this.isScrolled=!1,this.scrollTimer=null,this.#Y()}))}),this.options.scrollDelay)}#R(e,t,s){this.scrollAnimationId&&(cancelAnimationFrame(this.scrollAnimationId),this.scrollAnimationId=null);const i=window.scrollY||document.documentElement.scrollTop,r=e-i;if(Math.abs(r)<1)return void s?.();const o=performance.now(),n=e=>{const l=e-o,a=Math.min(l/t,1),c=(h=a,1-Math.pow(1-h,3));var h;window.scrollTo(0,i+r*c),a<1?this.scrollAnimationId=requestAnimationFrame(n):(this.scrollAnimationId=null,s?.())};this.scrollAnimationId=requestAnimationFrame(n)}#S(e){const{nav:t}=e;t.addEventListener("click",(e=>{const t=e.target.closest(s);if(t){e.preventDefault();const s=t.getAttribute("href");s&&s.startsWith("#")&&history.pushState(null,"",s)}}))}#n(){this.hashHandler=()=>this.#X(),window.addEventListener("hashchange",this.hashHandler)}#c(){decodeURIComponent(document.location.hash)?this.#X():this.#W(),setTimeout((()=>{this.#_()}),100)}#X(e=null,t=!0,s=!1){if(!e&&this.isTargetedActivation)return void(this.isTargetedActivation=!1);const i=decodeURIComponent(document.location.hash);i&&(e?this.#j(e,i,t):s||this.switchers.forEach((e=>{this.#j(e,i,t)})))}#j(e,t,i){const{nav:r,style:o,wrapper:n,options:l}=e,a=r.querySelector(`a[href="${t}" i]${s}`);if(!a)return;const c="accordion"===o?p:g,h=a.parentNode;if(!(h instanceof HTMLElement))return;if("accordion"===o&&h.classList.contains(c))return;const u=h.dataset.index;if(this.#$(r,o,u),i&&!this.isScrolled&&this.#G(t)){const e="accordion"===o?a:n;this.#P(e,o,l.scrollOffset)}}#q(e,t,s,i){const r=new URL(t,window.location.href);e.nav.querySelector(`a[href="${r.hash}"]`)&&setTimeout((()=>this.#X(e,s,i)),100)}#O(e,t){e.querySelectorAll("a").forEach((e=>e.classList.remove(m))),t&&t.classList.add(m)}#B(e,t=null){e&&this.toggles.forEach((s=>{const{element:i,id:r}=s;if(r&&!this.#x(r)){if(t&&r!==t)return;const s=document.querySelector(`#fs-${r}`);if(s){const t=this.switchers.get(s),r=e||this.#J(t);if(r){const e=i.querySelector(`a[href="${r}" i]`);this.#O(i,e)}}}else if(!r&&!t){const t=i.querySelector(`a[href="${e}" i]`);this.#O(i,t)}}))}#W(){this.toggles.forEach((e=>{const{id:t,element:s}=e;if(t&&!this.#x(t)){const e=document.querySelector(`#fs-${t}`);if(!e)return;const i=this.switchers.get(e),r=this.#J(i);if(r){const e=s.querySelector(`a[href="${r}" i]`);this.#O(s,e)}}}))}#_(){this.toggles.forEach((e=>{const{id:t,element:s}=e;if(t&&!this.#x(t)){const e=document.querySelector(`#fs-${t}`);if(!e)return;const i=this.switchers.get(e);if(!i)return;const r=this.#J(i);if(r){const e=s.querySelector(`a[href="${r}" i]`);this.#O(s,e)}}}))}#J(e){if(!e)return null;const t="accordion"===e.style?p:g,s=e.nav.querySelector(`:scope > .${t}`);if(!s)return null;const i=s.querySelector("a");return i?i.getAttribute("href"):null}#U(e,t){if(!t)return;const i=t.querySelector(s);if(!i)return;const r=i.getAttribute("href");if(!r)return;const o=e.wrapper.getAttribute("id");o&&this.toggles.forEach((e=>{const{id:t,element:s}=e;if(t&&!this.#x(t)&&o===`fs-${t}`){const e=s.querySelector(`a[href="${r}" i]`);this.#O(s,e)}}))}#$(e,t,s){switch(t){case"tab":UIkit.tab(e).show(s);break;case"accordion":UIkit.accordion(e).toggle(s);break;default:UIkit.switcher(e).show(s)}}#h(){if(this.isBuilderContext)try{window.parent.Vue.events.on("loadPreview",(()=>{this.#K()}),{priority:-10}),this.#g("info","Builder integration successful")}catch(e){this.#g("warn","Failed to setup Builder integration",e),this.#Q()}else this.#Q()}#Q(){this.builderObserver||(this.builderObserver=new MutationObserver((e=>{for(const t of e)for(const e of t.addedNodes)if("customizer-data"===e.id)return this.#g("info","Customizer update detected (fallback)"),void this.#K()})),this.builderObserver.observe(document.head,{childList:!0}),this.#g("info","Fallback observer attached"))}#K(){this.#g("info","Builder update detected"),this.switchers.forEach(((e,t)=>{document.contains(t)&&!t.hasAttribute(c)?(this.#g("debug",`Cleaning up builder-updated switcher: ${this.#m(t)}`),this.#Z(t)):document.contains(t)||(this.#g("debug",`Cleaning up removed switcher: ${this.#m(t)}`),this.switchers.delete(t))})),this.toggles.forEach(((e,t)=>{document.contains(t)||this.#ee(t)})),requestAnimationFrame((()=>{this.#l(),this.#a(),this.#c()}))}#u(){if(this.domObserver)return;let t,s=!1;const i=()=>{s||(s=!0,clearTimeout(t),t=setTimeout((()=>{s=!1,this.#l(),this.#a()}),50))};this.domObserver=new MutationObserver((t=>{let s=!1;for(const i of t)if("childList"===i.type){for(const t of i.addedNodes)if(t.nodeType===Node.ELEMENT_NODE&&(t.classList?.contains("fs-switcher")&&!t.dataset.initialized||t.querySelector?.(e)||t.classList?.contains("fs-switcher-toggle")&&!this.toggles.has(t)||t.querySelector?.(a))){s=!0;break}for(const e of i.removedNodes)if(e.nodeType===Node.ELEMENT_NODE){if(this.switchers.has(e))this.#Z(e);else if(e.querySelectorAll){e.querySelectorAll(".fs-switcher").forEach((e=>{this.switchers.has(e)&&this.#Z(e)}))}if(this.toggles.has(e))this.#ee(e);else if(e.querySelectorAll){e.querySelectorAll(".fs-switcher-toggle").forEach((e=>{this.toggles.has(e)&&this.#ee(e)}))}}}s&&i()})),this.domObserver.observe(this.options.container,{childList:!0,subtree:!0}),this.#g("info","DOM observer started")}#d(){this.visibilityHandler=()=>{this.isTabVisible=!document.hidden,this.#g("debug","Tab visibility changed: "+(this.isTabVisible?"visible":"hidden")),this.switchers.forEach((e=>{this.isTabVisible?this.#N(e):this.#z(e)}))},document.addEventListener("visibilitychange",this.visibilityHandler),this.#g("info","Tab visibility listener registered")}#Z(e){const t=this.switchers.get(e);if(!t)return;const{nav:s,handlers:i,autoplay:r}=t;i.click&&s.removeEventListener("click",i.click),i.mouseover&&s.removeEventListener("mouseover",i.mouseover),i.mouseleave&&s.removeEventListener("mouseleave",i.mouseleave),i.scrollClick&&s.removeEventListener("click",i.scrollClick),i.scrollHover&&s.removeEventListener("mouseover",i.scrollHover),r&&clearTimeout(r.timer),e.removeAttribute(c),e.removeAttribute(h),this.switchers.delete(e),this.#g("debug",`Cleaned up switcher: ${this.#m(e)}`)}#ee(e){const t=this.toggles.get(e);if(!t)return;const{handlers:s}=t;s.mousedown&&e.removeEventListener("mousedown",s.mousedown),s.mousemove&&e.removeEventListener("mousemove",s.mousemove),s.click&&e.removeEventListener("click",s.click),this.toggles.delete(e),this.#g("debug","Cleaned up toggle")}get debug(){return this.options.debug}set debug(e){this.options.debug=!!e,this.#g("info","Debug mode "+(this.options.debug?"enabled":"disabled"))}getSwitcher(e){return this.switchers.get(e)||null}getToggle(e){return this.toggles.get(e)||null}refresh(){this.#g("info","Refreshing all switchers"),this.switchers.forEach(((e,t)=>{t.removeAttribute(c),t.removeAttribute(h)})),this.switchers.clear(),this.toggles.clear(),this.#l(),this.#a(),this.#c()}pauseAll(e=!0){let t=0;return this.switchers.forEach((s=>{e?this.#z(s):this.#N(s),t++})),this.#g("info",`All autoplay ${e?"paused":"resumed"} (${t} switchers)`),t}destroy(){this.#g("info","Destroying switcher manager");try{this.domObserver&&(this.domObserver.disconnect(),this.domObserver=null),this.builderObserver&&(this.builderObserver.disconnect(),this.builderObserver=null),this.hashHandler&&(window.removeEventListener("hashchange",this.hashHandler),this.hashHandler=null),this.visibilityHandler&&(document.removeEventListener("visibilitychange",this.visibilityHandler),this.visibilityHandler=null),this.switchers.forEach(((e,t)=>{this.#Z(t)})),this.switchers.clear(),this.toggles.forEach(((e,t)=>{this.#ee(t)})),this.toggles.clear(),f.#e=null,window.FSSwitcherManager===this&&delete window.FSSwitcherManager,this.#g("info","Switcher manager destroyed")}catch(e){console.error("[FSSwitcherManager] Error during destruction:",e)}}#x(e){return this.options.excludeIds.some((t=>e.includes(t)))}#G(e){const t=Date.now(),s=t-f.#s>2e3;return!(f.#t===e&&!s)&&(f.#t=e,f.#s=t,!0)}#Y(){f.#t=null,f.#s=0}#m(e){return e.id||e.className.split(" ")[0]||`switcher-${Array.from(this.switchers.keys()).indexOf(e)}`}#g(e,t,...s){if(!this.options.debug)return;console["error"===e?"error":"warn"===e?"warn":"debug"===e?"debug":"log"]("[FSSwitcherManager]",t,...s)}}function w(){const e=f.getInstance({debug:!1});"undefined"!=typeof window&&(window.FSSwitcherManager=e)}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",w):w()})();