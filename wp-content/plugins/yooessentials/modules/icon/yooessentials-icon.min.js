/* Essentials YOOtheme Pro 2.4.12 build 1202.1125; ZOOlanders https://www.zoolanders.com; Copyright (C) Joolanders, SL; http://www.gnu.org/licenses/gpl.html GNU/GPL */

(function(v,k,c,f,_,m,u,r,$){"use strict";const y={};var b={name:"IconsModel",data:()=>{var e,t;return{collections:Object.values((t=(e=c.customizer)==null?void 0:e.icon_collections)!=null?t:{})||[]}},methods:{add(e){return f.icon.add(e),Object.keys(e)},addCollection(e){return _("yooessentials/icon/collection/add").post({name:e.name}).json(t=>{this.collections=Object.values(t)}).catch(()=>{f.modal.alert(`
                        <div class="uk-text-lead">Ups! The collection installation has failed.</div>
                        <p>It could be the server blocking the download, in which case you could try <a href="${e.package}" target="_blank">downloading</a> the collection and installing it manually following <a href="https://zoolanders.com/docs/essentials-for-yootheme-pro/icons/custom-collections" target="_blank">this guide</a>.</p>
                    `)})},removeCollection(e){return _("yooessentials/icon/collection/remove").post({name:e.name}).json(t=>{this.collections=Object.values(t)}).catch(t=>{f.notification(t==null?void 0:t.json,"danger")})},fetch(e={},t=!1){const n=JSON.stringify(e),o=y[n];return new Promise((s,l)=>{if(!t&&o){s(o);return}_("yooessentials/icon/list").post(e).json(i=>{i.data=this.add(i.data),y[n]=i,s(i)}).catch(l)})}}};function a(e,t,n,o,s,l,i,d){var h=typeof e=="function"?e.options:e;return t&&(h.render=t,h.staticRenderFns=n,h._compiled=!0),{exports:e,options:h}}const x={props:{icons:{type:Array,required:!0}}};var w=function(){var t=this,n=t._self._c;return n("div",[n("table",{staticClass:"uk-table uk-table-divider uk-table-hover uk-table-middle"},[n("thead",[n("tr",[n("th",{attrs:{colspan:"2"}},[t._v(t._s(t.$t("Icon")))]),t._v(" "),n("th",{staticClass:"uk-table-shrink"},[t._v(t._s(t.$t("Collection")))]),t._v(" "),n("th",{staticClass:"uk-table-shrink"},[t._v(t._s(t.$t("Group")))])])]),t._v(" "),n("tbody",t._l(t.icons,function({name:o,group:s,collection:l,key:i}){return n("tr",{key:i,staticClass:"uk-visible-hover",on:{click:function(d){return t.$emit("resolve",i)}}},[n("td",{staticClass:"uk-table-shrink uk-text-center"},[n("span",{staticClass:"yo-finder-list-image uk-icon-image",attrs:{"uk-icon":i}})]),t._v(" "),n("td",{staticClass:"uk-table-expand uk-text-nowrap"},[t._v(`
                    `+t._s(o)+`
                `)]),t._v(" "),n("td",{staticClass:"uk-text-nowrap"},[t._v(`
                    `+t._s(l)+`
                `)]),t._v(" "),n("td",{staticClass:"uk-text-nowrap"},[t._v(`
                    `+t._s(s)+`
                `)])])}),0)])])},I=[],F=a(x,w,I),M=F.exports;const R={props:{icons:{type:Array,required:!0}}};var D=function(){var t=this,n=t._self._c;return n("div",{staticClass:"uk-grid-collapse uk-child-width-auto",attrs:{"uk-grid":""}},t._l(t.icons,function(o){return n("div",{key:o.key},[n("div",{staticClass:"uk-card uk-card-small uk-card-body uk-card-hover yo-panel uk-inline",staticStyle:{width:"80px",height:"80px"}},[n("span",{attrs:{icon:o.key,"uk-icon":"",width:"80",height:"80"}}),t._v(" "),n("a",{staticClass:"uk-position-cover",attrs:{title:o.key,href:"","uk-tooltip":"delay: 500; position: top"},on:{click:function(s){return s.preventDefault(),t.$emit("resolve",o.key)}}})])])}),0)},j=[],S=a(R,D,j),O=S.exports;const A={props:{collections:{type:Array,required:!0},filter:{type:Object,default:()=>({search:"",collection:"",group:""})}},computed:{isFiltered(){return this.filter.collection||this.filter.group}},watch:{filter:{handler(e){const t=this.collections.find(n=>n.name===e.collection);(t&&!t.groups||e.group||!e.collection&&!e.group)&&this.$emit("hide")},deep:!0}},methods:{applyFilter(e){e.collection&&this.filter.collection!==e.collection&&(e.group=""),this.$emit("update:filter",{...this.filter,...e})},reset(){this.collections.length===1?this.applyFilter({group:""}):this.applyFilter({collection:"",group:""})}}};var B=function(){var t=this,n=t._self._c;return n("div",[n("div",{staticClass:"yo-dropdown-body uk-overflow-auto uk-height-max-medium"},[n("ul",{staticClass:"uk-nav uk-dropdown-nav"},[t.collections.length?n("li",{staticClass:"uk-nav-header uk-flex uk-position-relative"},[t._v(`
                `+t._s(t.$t("Filter by"))+`
                `),t.isFiltered?n("span",{staticClass:"uk-link uk-margin-small-right uk-position-center-right uk-position-medium",attrs:{"uk-icon":"close",ratio:"0.7",title:t.$t("Reset Filters"),"uk-tooltip":"delay: 500"},on:{click:function(o){return o.preventDefault(),t.reset.apply(null,arguments)}}}):t._e()]):t._e(),t._v(" "),t._l(t.collections,function({name:o,title:s,groups:l=[]}){return n("li",{key:o,class:{"uk-active":t.filter.collection===o,"uk-parent":l.length}},[t.collections.length>1?n("a",{attrs:{href:"#"},on:{click:function(i){return i.preventDefault(),t.applyFilter({collection:o})}}},[t._v(t._s(s))]):n("a",{staticClass:"uk-disabled",attrs:{href:"#"},on:{click:function(i){i.preventDefault()}}},[t._v(t._s(s))]),t._v(" "),l.length>1&&(t.filter.collection===o||t.collections.length===1)?n("ul",{staticClass:"uk-nav-sub"},t._l(l,function(i){return n("li",{key:i,class:{"uk-active uk-text-bold":t.filter.group===i}},[n("a",{attrs:{href:"#"},on:{click:function(d){return d.preventDefault(),t.applyFilter({group:i})}}},[t._v(t._s(i||t.$t("Main")))])])}),0):t._e()])})],2)])])},L=[],T=a(A,B,L),q=T.exports;const g="yooessentials.icons.view",z={name:"IconFinder",components:{List:M,Thumbnail:O,Finder:r.Finder},props:{items:r.Finder.props.items,total:r.Finder.props.total,menu:{type:Boolean,default:!0},addCollection:{type:Boolean,default:!1},collections:{type:Array,default:()=>[]},fetching:{type:Boolean,default:!1}},data:()=>({view:u.storage[g]||"thumbnail",filter:{search:"",collection:"",group:""}}),computed:{icons(){return this.items.map(this.parse)}},watch:{view(e){u.storage[g]=e},filter:{handler:u.debounce(function(){this.fetch({...this.filter,offset:0})},100),deep:!0}},methods:{fetch(e){this.$emit("fetch",e)},fetchNext(){this.items.length<this.total&&this.fetch({...this.filter,offset:this.items.length})},parse(e){var i;const t=e.match(/^([^-]*)-?(.*)--(.*)$/);if(!t)throw new Error(`Bad Formated Icon Name: ${e}`);const n=u.keyBy(this.collections,"name"),[,o,s,l]=t;return{collection:((i=n[o])==null?void 0:i.title)||o,group:s,name:l,key:e}},openCollectionsMenu(){m.uikit.openDropdown({functional:!0,render:e=>e(q,{props:{filter:this.filter,collections:this.collections,addCollection:this.addCollection},on:{hide:()=>dp.hide(),"update:filter":t=>this.filter=t,"add:collection":()=>this.$emit("add-collection")}})},{},this.$refs.menu,{pos:"bottom-right",classes:"yo-dropdown"})}}};var N=function(){var t=this,n=t._self._c;return n("Finder",{attrs:{"item-name":"Icon",items:t.icons,total:t.total,filter:t.filter},on:{"update:filter":function(o){t.filter=o}},scopedSlots:t._u([{key:"count",fn:function(){return[n("h2",{staticClass:"uk-modal-title uk-margin-remove"},[t._v(`
            `+t._s(t.$t("%smart_count% Icon |||| %smart_count% Icons",t.total))+`
            `),t.collections.length>1?n("span",{staticClass:"uk-text-meta uk-display-block"},[t._v(t._s(t.$t("%smart_count% Collection |||| %smart_count% Collections",t.collections.length)))]):t._e()])]},proxy:!0},{key:"right",fn:function(){return[n("ul",{staticClass:"uk-grid-small uk-child-width-auto",attrs:{"uk-grid":""}},[n("li",{class:{"uk-active":t.view==="list"}},[n("a",{staticClass:"uk-icon-link",attrs:{href:"",title:t.$t("List"),"uk-icon":"table","uk-tooltip":"delay: 500"},on:{click:function(o){o.preventDefault(),t.view="list"}}})]),t._v(" "),n("li",{class:{"uk-active":t.view==="thumbnail"}},[n("a",{staticClass:"uk-icon-link",attrs:{href:"",title:t.$t("Thumbnails"),"uk-icon":"thumbnails","uk-tooltip":"delay: 500"},on:{click:function(o){o.preventDefault(),t.view="thumbnail"}}})]),t._v(" "),t.menu?n("li",{ref:"menu"},[n("a",{staticClass:"uk-icon-link",attrs:{href:"","uk-icon":"more-vertical"},on:{click:function(o){return o.preventDefault(),t.openCollectionsMenu.apply(null,arguments)}}})]):t._e()])]},proxy:!0},{key:"items",fn:function(){return[n(t.view,{tag:"component",attrs:{icons:t.icons},on:{resolve:function(o){return t.$emit("resolve",o)}}}),t._v(" "),t.fetching?n("div",{staticClass:"uk-flex uk-flex-center uk-padding-small"},[n("span",{attrs:{"uk-spinner":"",ratio:"0.9"}})]):t.total>t.icons.length?n("div",{staticClass:"uk-text-center"},[n("a",{staticClass:"uk-icon-link",attrs:{"uk-icon":"more",ratio:"2",title:t.$t("Load More"),href:"","uk-tooltip":"delay: 500"},on:{click:function(o){return o.preventDefault(),t.fetchNext()}}})]):t._e()]},proxy:!0}])})},G=[],E=a(z,N,G),C=E.exports;const P={name:"Collections",components:{IconFinder:C},data:()=>({icons:[],total:0,batch:500,fetching:!1,query:{}}),computed:{collections(){return c.helpers.Icons.collections.filter(e=>e.installed&&e.name!=="myicons")}},created(){this.fetch()},methods:{async addCollection(){const e=await m.uikit.promptModal(r.ItemsFinderModal,{items:c.helpers.Icons.collections.filter(t=>!t.installed&&t.name!=="myicons")});e&&(await c.helpers.Icons.addCollection(e),await this.fetch({},!0))},fetch(e={},t=!1){return this.fetching=!0,e={offset:0,length:this.batch,...e},c.helpers.Icons.fetch(e,t).then(n=>{const{total:o,data:s}=n;e.offset===0?(this.total=o,this.icons=s):this.icons=[...this.icons,...s],this.fetching=!1})}}};var U=function(){var t=this,n=t._self._c;return t.collections.length?n("IconFinder",{attrs:{items:t.icons,total:t.total,fetching:t.fetching,collections:t.collections},on:{fetch:t.fetch,resolve:function(o){return t.$emit("select",o)}}}):n("div",{staticClass:"uk-height-medium uk-flex"},[n("div",{staticClass:"uk-margin-auto uk-margin-auto-vertical uk-text-center"},[n("p",{staticClass:"uk-text-lead uk-text-center"},[t._v(`
            `+t._s(t.$t("Start by adding your first Icon Collection"))+`
        `)]),t._v(" "),n("button",{staticClass:"uk-button uk-button-primary",on:{click:t.addCollection}},[t._v(`
            `+t._s(t.$t("Add Collection"))+`
        `)]),t._v(" "),n("p",{staticClass:"uk-text-meta uk-text-center"},[t._v(`
            `+t._s(t.$t("Or manage all collections in the Essentials Section."))+`
        `)])])])},J=[],V=a(P,U,J),p=V.exports;const H={name:"MyIcons",components:{IconFinder:C},extends:p,computed:{collection(){return c.helpers.Icons.collections.find(e=>e.name==="myicons")||{}},totalGroups(){var e;return((e=this.collection.groups)==null?void 0:e.length)||0}},created(){this.total=this.collection.icons||0,this.fetch()},methods:{fetch(e={},t=!1){p.methods.fetch.call(this,{...e,collection:"myicons"},t)}}};var K=function(){var t=this,n=t._self._c;return t.collection.icons===0?n("div",{staticClass:"uk-height-medium uk-flex"},[n("div",{staticClass:"uk-margin-auto uk-margin-auto-vertical uk-text-center"},[n("p",{staticClass:"uk-text-lead uk-text-center"},[t._v(t._s(t.$t("MyIcons is your Icon Collection")))]),t._v(" "),n("p",{staticClass:"uk-text-muted uk-text-center"},[t._v(`
            `+t._s(t.$t('Start by placing icons into the "child_theme/myicons" folder.'))+`
        `)])])]):n("IconFinder",{attrs:{menu:t.totalGroups>1,items:t.icons,total:t.total,fetching:t.fetching,collections:[t.collection]},on:{fetch:t.fetch,resolve:function(o){return t.$emit("select",o)}}})},Q=[],W=a(H,K,Q),X=W.exports;const Y={name:"CollectionsSection",components:{ResourceListItem:r.ResourceListItem},props:{panel:Object},computed:{installed(){return c.helpers.Icons.collections.filter(e=>e.version&&e.installed).map(e=>({collection:e,title:e==null?void 0:e.title,meta:`v${e==null?void 0:e.installed}`,icon:e==null?void 0:e.icon,actions:["delete"]}))}},methods:{isEmpty:$.isEmpty,remove(e){c.helpers.Icons.removeCollection(e)},async add(){const e=await m.uikit.promptModal(r.ResourcePicker,{items:c.helpers.Icons.collections.filter(t=>t.package).map(t=>({...t,disabled:!!t.installed,description:t.installed?"Installed":t.description}))},{container:!0});e&&c.helpers.Icons.addCollection(e)},isUpToDate(e){return u.semverCompare(e.installed,e.version)>=0}}};var Z=function(){var t=this,n=t._self._c;return n("div",{staticClass:"uk-margin-remove-first-child"},[t.isEmpty(t.installed)?t._e():n("ul",{staticClass:"uk-nav uk-nav-default yo-sidebar-marginless yo-nav-iconnav uk-margin uk-margin-remove-bottom"},t._l(t.installed,function({collection:o,title:s,icon:l,meta:i,actions:d}){return n("ResourceListItem",{key:o.id,attrs:{title:s,icon:l,meta:i,actions:d},on:{delete:function(h){return t.remove(o)}}})}),1),t._v(" "),n("button",{staticClass:"uk-button uk-button-default uk-width-1-1 uk-margin-medium-top",attrs:{type:"button"},on:{click:t.add}},[t._v(`
        `+t._s(t.$t("Add Collection"))+`
    `)]),t._v(" "),n("p",{staticClass:"uk-text-muted"},[t._v(`
        `+t._s(t.$t("Add a preset Icon Collection to the icon library. For custom collections consult the documentation."))+`
    `)])])},tt=[],et=a(Y,Z,tt),nt=et.exports;v.component("yooessentials-icon-collections",nt),k.after("app.init",()=>{c.helpers.Icons=new v(b)}),k.before("app.init",({extend:e})=>{e({events:{iconsModalTabs:({result:t=[]})=>{var n,o;return(o=(n=c.customizer)==null?void 0:n.icon_collections)!=null&&o.myicons&&t.push({name:"My Icons",component:X}),t.push({name:"Collections",component:p}),t}}})})})(Vue,yootheme.hooks,yooessentials,UIkit,yootheme.http,yootheme,yooessentials.util,yooessentials.components,UIkit.util);
