/* Essentials YOOtheme Pro 2.4.12 build 1202.1125; ZOOlanders https://www.zoolanders.com; Copyright (C) Joolanders, SL; http://www.gnu.org/licenses/gpl.html GNU/GPL */

(function(d,F,$,a,C,c,N,O,B){"use strict";function _(r,e,t,o,n,i,s,p){var l=typeof r=="function"?r.options:r;return e&&(l.render=e,l.staticRenderFns=t,l._compiled=!0),{exports:r,options:l}}const j={name:"FormActionsFields",extends:$.components.FieldYooessentialsDatasetMulti,computed:{options(){var t;const r=((t=a.customizer)==null?void 0:t.form_actions)||{};return Object.entries(r).reduce((o,[n,i])=>(o[n]={...i,panel:i,titleFallback:i.title},o),{})}}};var q=_(j,null,null),R=q.exports;function m(r){var e,t;return(t=(e=r==null?void 0:r.props)==null?void 0:e.yooessentials_form)==null?void 0:t.state}function v(r){var e;return!!((e=a.yoo.Builder.types[r==null?void 0:r.type])!=null&&e.submittable)}function S(r){var e;return!m(r)&&!!((e=a.yoo.Builder.types[r==null?void 0:r.type])!=null&&e.element)}function g(r){return!!D(r).length}function k(r){return!!f(r,a.yoo.Builder).length}function D(r,e=!0){return C.flattenChildren(r,e).filter(m)}function f(r){return C.flattenChildren(r).filter(v)}function h(r){var e,t,o,n,i,s;for(r=((t=(e=a.yoo)==null?void 0:e.Builder)==null?void 0:t.adjacentOf)||((n=(o=a.yoo)==null?void 0:o.Builder)==null?void 0:n.parent(r));r&&!m(r);)r=(s=(i=a.yoo)==null?void 0:i.Builder)==null?void 0:s.parent(r);return r}var z=Object.freeze({__proto__:null,getClosestFormArea:h,getFormAreas:D,getFormFields:f,hasFormAreas:g,hasFormFields:k,isElement:S,isFormArea:m,isFormField:v});const x={"duplicated-control":"Name already assigned to another field.","invalid-chars":"Name contains invalid characters."},I={extends:$.components.FieldText,inject:["$node"],computed:{error(){if(!this.value)return!1;if(this.value.match(/[^a-zA-Z0-9_\-[\]]/))return x["invalid-chars"];const r=h(this.$node);return f(r).map(o=>{var n;return(n=o.props)==null?void 0:n.control_name}).filter(o=>o===this.value).length>1?x["duplicated-control"]:!1}}};var T=function(){var e=this,t=e._self._c;return t("div",[t("input",{directives:[{name:"model",rawName:"v-model",value:e.value,expression:"value"}],staticClass:"uk-input",class:{"uk-form-danger":e.error},attrs:{type:"text"},domProps:{value:e.value},on:{input:function(o){o.target.composing||(e.value=o.target.value)}}}),e._v(" "),e.error?t("span",{staticClass:"uk-text-meta"},[e._v(e._s(e.$t(e.error)))]):e._e()])},Y=[],L=_(I,T,Y),M=L.exports;const W={name:"FormControlSelect",extends:$.components.FieldYooessentialsSelectDropdown,inject:["$node"],computed:{status(){return!this.value||this.fields.some(r=>{var e;return((e=r.props)==null?void 0:e.control_name)===this.value})},fields(){const r=h(this.$node);return f(r).filter(t=>{var o;return t==null?void 0:t.type.match((o=this.field)==null?void 0:o.filterType)}).filter(t=>t==null?void 0:t.props.control_name)}},created(){this.entries=this.fields.map(r=>({value:r.props.control_name,text:r.props.control_label||r.props.control_name}))}};var E=_(W,null,null),H=E.exports,Q=Object.freeze({__proto__:null,FieldYooessentialsFormActions:R,FieldYooessentialsFormControl:M,FieldYooessentialsFormControlSelect:H});const X={"duplicated-form-area":"Duplicated Form Area","duplicated-field-control":"Duplicated field Control Name","field-outside-form-area":"Field outside a Form Area","contains-fields-outside-form-area":"Contains fields outside a Form Area"},Z={name:"FormAreaIcon",props:{node:{type:Object,required:!0},contains:{type:Array,default:()=>[]},error:{type:[String,Boolean],default:""},tooltipDirection:{type:String,default:"bottom"}},computed:{formAreaNode(){return m(this.node.node)?this.node.node:this.contains.length>1?null:this.contains[0]},icon(){return`ye-builder-icon-form${this.error?"-error":""}`},title(){const{node:r}=this.node;return this.error?X[this.error]||"Invalid Form Area":m(r)?"Form Area":this.contains.length?"Contains Form Area":""}},methods:{openFormAreaSettings(){this.$trigger("yeOpenFormAreaSettings",this.formAreaNode)}}};var G=function(){var e=this,t=e._self._c;return e.formAreaNode&&!e.error?t("a",{class:e.icon,attrs:{href:"#",title:e.$t(e.title),"uk-tooltip":`delay: 1000; pos: ${e.tooltipDirection}`},on:{click:function(o){return o.preventDefault(),e.openFormAreaSettings.apply(null,arguments)}}}):t("span",{class:e.icon,attrs:{title:e.$t(e.title),"uk-tooltip":`delay: 1000; pos: ${e.tooltipDirection}`}})},J=[],K=_(Z,G,J),w=K.exports;const U={name:"FormAreaButton",props:{node:Object}};var V=function(){var e=this,t=e._self._c;return t("button",{staticClass:"uk-button uk-button-small uk-button-default",attrs:{type:"button"},on:{click:function(o){return e.$trigger("yeOpenFormAreaSettings",e.node)}}},[e._v(`
    `+e._s(e.$t("Form Settings"))+`
`)])},ee=[],te=_(U,V,ee),re=te.exports;const oe={name:"FormPlaceholderDrop",components:{DropdownList:N.DropdownList},props:{entries:Array},computed:{entriesList(){return this.entries.map(r=>({...r,group:"Form"}))}}};var ne=function(){var e=this,t=e._self._c;return t("div",[t("DropdownList",{attrs:{entries:e.entriesList},scopedSlots:e._u([{key:"entry",fn:function({entry:o}){return[t("li",{staticClass:"uk-visible-toggle uk-position-relative",on:{click:function(n){return n.preventDefault(),e.$emit("resolve",o)}}},[t("a",{staticStyle:{cursor:"default !important"}},[e._v(`
                    `+e._s(o.text)+`
                    `),o.meta?t("span",{staticClass:"uk-text-meta uk-margin-small-left"},[e._v(e._s(o.meta))]):e._e()])])]}}])})],1)},se=[],ie=_(oe,ne,se),ae=ie.exports;c.events.on("layoutButtons",({result:r=[]},{node:e}={})=>m(e)?[...r,{component:re,node:e}]:r,-10),c.events.on("statusIconsNode",({origin:r,result:e=[]})=>{const{node:t}=r;if(m(t)&&t.type!=="column")return[...e,{component:w,error:A(t)}];if(t.type.match(/^(row|fragment)$/)&&g(t)){const o=D(t,t.type!=="row");if(o.length)return e.push({component:w,contains:o,error:A(t)}),e}return A(t)&&(v(t)||S(t)&&k(t))?[...e,{component:w,error:A(t)}]:e});function A(r){var t;const e=h(r);if(!e&&v(r))return"field-outside-form-area";if(!e&&k(r)&&S(r)&&!g(r))return"contains-fields-outside-form-area";if(e&&(r.type==="fragment"&&(m(r)||g(r))||r.type.match(/^(row|yooessentials_form_fieldset)$/)&&g(r)))return"duplicated-form-area";if(v(r)){const o=f(e),n=(t=r.props)==null?void 0:t.control_name;if(o.map(s=>{var p;return(p=s.props)==null?void 0:p.control_name}).filter(Boolean).filter(s=>s===n).length>1)return"duplicated-field-control"}return!1}let P,y=null;F.after("app.init",()=>{P=d.builder.schema}),F.after("app.init",()=>{const r={name:"yooessentials_form_query"},e={priority:90,name:"yooessentials.form",group:"primary",title:"Submission",description:"Form submission source",query:()=>r,queries:()=>y?[{name:r.name,metadata:{option:"yooessentials.form",label:c.i18n.t("Form"),group:c.i18n.t("Submission"),description:c.i18n.t("Form submission source")},type:{name:"YooessentialsForm"}}]:[],match:({prop:t})=>{var o;return((o=t==null?void 0:t.query)==null?void 0:o.name)===r.name},matchNode:()=>!!y,resolve:({prop:t})=>{t.query={...t.query||{},...r}}};a.helpers.Dynamic&&a.helpers.Dynamic.$options.dynamicOptions.push(e)}),c.events.on("yooessentialsSourceQueryOrigin",({result:r},{node:e,prop:t})=>{var o;if(r)return r;if(t=a.helpers.Source.getProp(e,t),((o=t==null?void 0:t.query)==null?void 0:o.name)==="yooessentials_form_query")return"yooessentials.form"}),c.events.on("transformedNode",(r,e,t)=>{t.children&&t.type.startsWith("yooessentials_form_")&&e.type.startsWith("yooessentials_form_")&&t.children.every(o=>o.type==="yooessentials_form_option")&&(e.children=t.children)}),c.events.on("openPanel",(r,e)=>{var n,i;const o=[e,...((n=r.sidebar)==null?void 0:n.stack)||[]].find(s=>s.name==="yooessentials-form-settings");if(o&&!y){const s=(i=o.props)==null?void 0:i.node;if(m(s)){y=s;const l=f(s,a.yoo.Builder).filter(u=>{var b;return(b=u.props)==null?void 0:b.control_name});l.length&&O("yooessentials/form/schema").post({controls:l}).json(u=>{d.builder.schema=u})}}}),c.events.on("closePanel",(r,e,t)=>{t.name==="yooessentials-form-settings"&&(y=null,d.builder.schema=P)}),c.events.on("essentialsDynamicOptionMatchNode",({result:r},e)=>(r=r||e,y?r.filter(t=>!["node","parent","page"].includes(t.name)):r),-100),F.before("app.init",({extend:r})=>{r({events:{async transformFormAreaToSublayout(e){const{node:t,builder:o}=e.origin.Fields;if(!t.type.match(/section|column/))throw new Error("The node is not a Section or Column.");const n=o.make("fragment");n.name=t.name||"Form Area",n.props.yooessentials_form=C.deepCopy(t.props.yooessentials_form),delete t.props.yooessentials_form;const i=o.make("row"),s=o.make("column");i.children=[s],t.type==="section"&&(n.children=t.children,delete t.children,s.children=[n],o.replaceChildren(t,[i])),t.type==="column"&&(s.children=t.children,delete t.children,n.children=[i],o.replaceChildren(t,[n]))}}})}),F.before("app.init",({extend:r})=>{r({events:{prepareFields:{handler({origin:{node:e}},t){if(h(e))for(const o of t){if(!o.formPlaceholder)continue;o.buttons=o.buttons||[];const n=d.builder.helpers.Source.getProp(e,o.name);o.buttons.unshift({label:c.i18n.t("Placeholder"),action:"yooessentialsPickFormPlaceholder",show:!n})}},priority:-15},yooessentialsPickFormPlaceholder:async({origin:e},t,{target:o})=>{const{node:n}=e,i=h(n),s=f(i).filter(l=>{var u;return(u=l.props)==null?void 0:u.control_name}).map(l=>{var b;const u=l.props.control_name;return{value:u,text:((b=l.props)==null?void 0:b.control_label)||u,meta:`{${u}}`}}),p=await d.uikit.promptDropdown(ae,{entries:s},o,{classes:"yo-dropdown",boundaryX:o.closest(".yo-sidebar-fields > *")||o});if(p!=null&&p.meta){if(!navigator.clipboard){B.notification({message:"Copying placeholder not supported, please input manually.",status:"danger",timeout:1500});return}navigator.clipboard.writeText(p.meta),B.notification({message:"Placeholder copied to clipboard!",status:"success",timeout:1500})}}}})}),Object.assign($.components,Q),F.before("app.init",({extend:r})=>{a.helpers.Form=z,r({events:{yeOpenFormAreaSettings(e,t){this.$trigger("openDynamicPanel",{...d.customizer.panels["yooessentials-form-settings"],heading:!1,props:{node:t,values:t==null?void 0:t.props}})}}})})})(yootheme,yootheme.hooks,yootheme.fields,yooessentials,yooessentials.util,Vue,yooessentials.components,yootheme.http,UIkit);
